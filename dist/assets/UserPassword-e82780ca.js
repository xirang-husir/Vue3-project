import"./_plugin-vue_export-helper-d0c954b5.js";import{v as E}from"./el-card-f7fee01d.js";import{a as P,E as y,b as F}from"./el-form-item-06b0de6d.js";import{E as U}from"./el-button-c351e2b8.js";import{P as x}from"./PageContainer-68ebf2e1.js";import{p,t as R,q,s as C,a7 as N,o as h,e as k,w as l,x as t,A as m,b_ as B,D as S}from"./index-40acc06f.js";/* empty css                   */import"./error-de6436bb.js";const K={__name:"UserPassword",setup(T){const i=p(!0);R(()=>{setTimeout(()=>{i.value=!1},750)});const s=p(null),_=q(),v=C(),r=p({old_pwd:"",new_pwd:"",re_pwd:""}),u=(n,e,o)=>{e.length<6||e.length>15?o(new Error("密码长度需为6-15位")):o()},f={old_pwd:[{required:!0,message:"请输入原密码",trigger:"blur"},{validator:u,trigger:"blur"}],new_pwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:u,trigger:"blur"},{validator:(n,e,o)=>{e===r.value.old_pwd?o(new Error("新密码不能和原密码相同")):(r.value.re_pwd&&e!==r.value.re_pwd&&s.value.validateField("re_pwd"),o())},trigger:"blur"}],re_pwd:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:u,trigger:"blur"},{validator:(n,e,o)=>{e!==r.value.new_pwd?o(new Error("两次输入的密码不一致")):o()},trigger:"blur"}]},g=async()=>{await s.value.validate(),await B(r.value),S.success("密码修改成功"),_.setToken(""),_.setUser({}),v.push("/login")},c=()=>{s.value.resetFields()};return(n,e)=>{const o=P,d=y,w=U,b=F,V=E;return N((h(),k(x,{title:"修改密码"},{default:l(()=>[t(b,{model:r.value,rules:f,ref_key:"pwdFormRef",ref:s,"label-position":"right","label-width":"100px"},{default:l(()=>[t(d,{label:"原密码",prop:"old_pwd"},{default:l(()=>[t(o,{modelValue:r.value.old_pwd,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value.old_pwd=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"新密码",prop:"new_pwd"},{default:l(()=>[t(o,{modelValue:r.value.new_pwd,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.new_pwd=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"确认密码",prop:"re_pwd"},{default:l(()=>[t(o,{modelValue:r.value.re_pwd,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.re_pwd=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,null,{default:l(()=>[t(w,{type:"primary",onClick:g},{default:l(()=>[m("修改密码")]),_:1}),t(w,{onClick:c},{default:l(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[V,i.value]])}}};export{K as default};
